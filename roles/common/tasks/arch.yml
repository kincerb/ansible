---
- name: Install common packages
  become: true
  community.general.pacman:
    name:
      - bat
      - neovim
      - nodejs
      - npm
      - rsync
      - socat
      - starship
      - the_silver_searcher
      - tmux
      - vim
      - xsel
    state: present
    update_cache: yes
  register: packages_installed

- name: Create link to bat from batcat
  become: true
  file:
    src: /usr/bin/bat
    dest: /usr/bin/batcat
    state: link
  when: "{{ packages_installed|selectattr('packages', 'contains', 'bat') }}"
...
